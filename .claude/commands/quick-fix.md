---
allowed-tools: ["Read", "Write", "Edit", "Bash", "Grep"]
description: 一般的なISUCONボトルネックを自動修正
---

ISUCONでよくあるパフォーマンス問題を自動的に検出して修正します。

以下の最適化を順番に実施：

1. N+1クエリの検出と修正
   - ループ内のデータベースアクセスを検出
   - JOIN句やバッチ取得に書き換え

2. 不要なSELECT *の修正
   - 必要なカラムのみを指定するように変更

3. インデックスの追加
   - WHERE句で頻繁に使用されるカラムにインデックス追加

4. 静的ファイルの配信最適化
   - nginx/Caddyの設定で静的ファイルを直接配信

5. セッション管理の最適化
   - RedisやMemcachedへの移行

6. ログレベルの調整
   - 本番環境用のログレベルに変更

7. データベース接続プールの設定
   - 適切なプールサイズの設定

各修正について、変更前後の差分を表示し、予想される改善効果を説明してください。